<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get a Repair Quote - Mcdowell Auto Services</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <h1>Mcdowell Auto Services</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About Us</a>
    <a href="services.html">Services</a>
    <a href="shop.html">Tyre Shop</a>
    <a href="booking.html">Book a Service</a>
    <a href="contact.html">Contact</a>
    <a href="blog.html">Blog</a>
    <a href="quote.html">Get a Quote</a>
  </nav>
</header>

<section class="hero">
  <h2>Get a Repair Quote</h2>
  <p>Enter your vehicle registration and postcode to see repair options and prices.</p>
</section>

<section class="services-preview">
  <form id="repair-quote-form">
    <input type="text" id="vrm" placeholder="Enter Vehicle Registration" required>
    <input type="text" id="postcode" placeholder="Enter Postcode" required>
    <button type="submit">Get Quote</button>
  </form>

  <div id="quote-results" style="margin-top:20px;"></div>
</section>

<footer>
  <p>üìû 07592 247 365 | ‚úâÔ∏è mcdowellautoservicesltd@gmail.com</p>
</footer>

<script>
document.getElementById('repair-quote-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  const vrm = document.getElementById('vrm').value.trim();
  const postcode = document.getElementById('postcode').value.trim();
  const resultsDiv = document.getElementById('quote-results');
  resultsDiv.innerHTML = "<p>Fetching quote‚Ä¶</p>";

  try {
    const response = await fetch(`https://vehicledatabases.com/portal/key?vrm=${vrm}&postcode=${postcode}`, {
      headers: {
        'Authorization': 'Bearer 5b7def82c33b11f0a35c0242ac120002',
        'Content-Type': 'application/json'
      }
    });

    const data = await response.json();

    if (!data || !data.repairs) {
      resultsDiv.innerHTML = "<p style='color:red;'>No quote available for this vehicle.</p>";
      return;
    }

    let html = `<h3>Repair Quote for ${data.vehicle.make} ${data.vehicle.model}</h3>`;
    html += "<ul>";
    data.repairs.forEach(r => {
      html += `<li>${r.name} - ¬£${r.price}</li>`;
    });
    html += "</ul>";

    html += `<button onclick="window.location.href='booking.html'">Book a Service</button>`;

    resultsDiv.innerHTML = html;

  } catch (err) {
    console.error(err);
    resultsDiv.innerHTML = "<p style='color:red;'>Error fetching quote. Please try again later.</p>";
  }
});
</script>

</body>
</html>
